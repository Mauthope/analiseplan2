<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gráfico de Média por Motivo</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h1>Gráfico de Médias por Motivo</h1>

    <!-- Mostrador para a média de "Rota1" -->
    <div>
        <h2>Média para Rota1: <span id="rota1-media"></span></h2>
    </div>

    <!-- Canvas para o gráfico -->
    <canvas id="myChart" width="400" height="200"></canvas>

    <script>
        // Dados simulados
        const data = [
            { motivo: 'Rota1', tempo: 12 },
            { motivo: 'Rota1', tempo: 15 },
            { motivo: 'Rota2', tempo: 8 },
            { motivo: 'Rota3', tempo: 20 },
            { motivo: 'Rota2', tempo: 10 },
            { motivo: 'Rota3', tempo: 18 },
            { motivo: 'Rota4', tempo: 25 },
            { motivo: 'Rota4', tempo: 22 },
        ];

        // Filtrar "Rota1" para cálculo da média específica
        const rota1Data = data.filter(item => item.motivo === 'Rota1');
        const rota1Media = rota1Data.reduce((sum, item) => sum + item.tempo, 0) / rota1Data.length;

        // Atualizar o mostrador com a média de "Rota1"
        document.getElementById('rota1-media').textContent = rota1Media.toFixed(2);

        // Calcular médias por motivo (excluindo "Rota1")
        const motivos = [...new Set(data.map(item => item.motivo))].filter(motivo => motivo !== 'Rota1');
        const medias = motivos.map(motivo => {
            const motivoData = data.filter(item => item.motivo === motivo);
            const media = motivoData.reduce((sum, item) => sum + item.tempo, 0) / motivoData.length;
            return { motivo, media };
        });

        // Ordenar os motivos pela média de forma decrescente
        medias.sort((a, b) => b.media - a.media);

        // Configurar o gráfico
        const ctx = document.getElementById('myChart').getContext('2d');
        new Chart(ctx, {
            type: 'bar',
            data: {
                labels: medias.map(item => item.motivo),
                datasets: [{
                    label: 'Média de Tempo',
                    data: medias.map(item => item.media),
                    backgroundColor: 'rgba(75, 192, 192, 0.2)',
                    borderColor: 'rgba(75, 192, 192, 1)',
                    borderWidth: 1
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: {
                        position: 'top',
                    },
                    tooltip: {
                        callbacks: {
                            label: function(context) {
                                return context.raw.toFixed(2) + ' minutos';
                            }
                        }
                    }
                },
                scales: {
                    y: {
                        beginAtZero: true,
                        title: {
                            display: true,
                            text: 'Tempo Médio (minutos)'
                        }
                    },
                    x: {
                        title: {
                            display: true,
                            text: 'Motivos'
                        }
                    }
                }
            }
        });
    </script>
</body>
</html>
