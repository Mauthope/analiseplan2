<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Table Comparison Charts</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .input-section {
            display: flex;
            justify-content: space-between;
            margin-bottom: 20px;
        }
        .table-input {
            width: 48%;
        }
        textarea {
            width: 100%;
            height: 200px;
        }
        .chart-container {
            display: flex;
            justify-content: space-between;
        }
        .chart {
            width: 48%;
        }
    </style>
</head>
<body>
    <h1>Table Comparison Charts</h1>
    <div class="input-section">
        <div class="table-input">
            <h2>Table 1</h2>
            <textarea id="table1" placeholder="Paste CSV data here"></textarea>
        </div>
        <div class="table-input">
            <h2>Table 2</h2>
            <textarea id="table2" placeholder="Paste CSV data here"></textarea>
        </div>
    </div>
    <button onclick="generateCharts()">Generate Charts</button>
    <div class="chart-container">
        <div class="chart">
            <canvas id="chart1"></canvas>
        </div>
        <div class="chart">
            <canvas id="chart2"></canvas>
        </div>
    </div>
    <script src="script.js"></script>
    <script>

        function parseCSV(csv) {
    const lines = csv.split('\n');
    const headers = lines[0].split(',');
    const data = [];
    for (let i = 1; i < lines.length; i++) {
        const values = lines[i].split(',');
        if (values.length === headers.length) {
            const entry = {};
            for (let j = 0; j < headers.length; j++) {
                entry[headers[j].trim()] = values[j].trim();
            }
            data.push(entry);
        }
    }
    return data;
}

function processData(data) {
    const groupedData = {};
    data.forEach(entry => {
        const motivo = entry['Motivos'];
        const tempo = parseFloat(entry['Tempo Decorrido (s)']);
        if (!groupedData[motivo]) {
            groupedData[motivo] = { total: 0, count: 0 };
        }
        groupedData[motivo].total += tempo;
        groupedData[motivo].count++;
    });

    const labels = [];
    const values = [];
    for (const [motivo, data] of Object.entries(groupedData)) {
        labels.push(motivo);
        values.push(data.total / data.count);
    }

    return { labels, values };
}

function createPieChart(ctx, labels, data) {
    return new Chart(ctx, {
        type: 'pie',
        data: {
            labels: labels,
            datasets: [{
                data: data,
                backgroundColor: [
                    '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0', '#9966FF',
                    '#FF9F40', '#FF6384', '#36A2EB', '#FFCE56', '#4BC0C0'
                ]
            }]
        },
        options: {
            responsive: true,
            title: {
                display: true,
                text: 'Average Time by Reason'
            }
        }
    });
}

function generateCharts() {
    const table1Data = parseCSV(document.getElementById('table1').value);
    const table2Data = parseCSV(document.getElementById('table2').value);

    const processedData1 = processData(table1Data);
    const processedData2 = processData(table2Data);

    const ctx1 = document.getElementById('chart1').getContext('2d');
    const ctx2 = document.getElementById('chart2').getContext('2d');

    createPieChart(ctx1, processedData1.labels, processedData1.values);
    createPieChart(ctx2, processedData2.labels, processedData2.values);
}


    </script>
</body>
</html>

